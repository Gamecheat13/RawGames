#include maps\_utility;
#include common_scripts\ambientpackage;
#include maps\_fx;

main()
{






// Ambient Emitters

//Room 1



	//loopSound("Amb_Rain_Int_01", (242, 725, 1058), 6.12);
	//loopSound("Amb_Rain_Int_01", (256, -111, 1148), 6.12);
	
	loopSound("Spot_Rain_Glass_Int", (249, -123, 1131), 6.12);
	loopSound("Spot_Rain_Glass_Int", (18, 12, 958), 6.12);
	
	loopSound("amb_Sci_Center_Mech_1", (139, 556, 1033), 6.12);
	//loopSound("amb_Sci_Center_Mech_2", (153, 313, 1044), 4.214);
	loopSound("amb_Sci_Center_Mech_2", (177, 89, 1042), 4.214);
	loopSound("amb_Sci_Center_Mech_3", (416, 109, 993), 6.12);
	//loopSound("amb_Sci_Center_Mech_2", (607, 103, 993), 4.214);
	//loopSound("amb_Sci_Center_Mech_1", (583, -111, 973), 4.214);
	
	loopSound("amb_int_elec_hum", (586, -97, 993), 3.249);
	loopSound("amb_int_elec_hum", (316, 424, 1024), 3.249);
	loopSound("amb_int_elec_hum", (364, 93, 993), 3.249);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-215, 15, 820), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (255, -153, 1101), 4.214);
	//loopSound("amb_water_drips_concrete", (288, 308, 1051), 8.445);
	//loopSound("amb_water_drips_concrete", (199, 562, 1027), 8.445);
	//loopSound("amb_water_drips_concrete", (279, -158, 1051), 8.445);
	//loopSound("amb_water_drips_with_metal", (171, 456, 1027), 7.409);
	//loopSound("amb_water_drips_with_metal", (359, -176, 1051), 7.409);
	
	loopSound("amb_light_buzz", (79.5, 460.5, 1087), .008);
	loopSound("amb_light_buzz", (76.5, 179.5, 1083), .008);
	loopSound("amb_light_buzz", (237.5, 707, 1071), .008);
	loopSound("amb_light_buzz", (243, -219.5, 1091), .008);
	loopSound("amb_light_buzz", (337, 95.5, 1071), .008);
	
	loopSound("Amb_Rain_Int_01", (238, 761, 1091), 6.12);
	loopSound("Amb_Rain_Int_01", (638, 324, 1091), 6.12);
	loopSound("Amb_Rain_Int_01", (468.5, -301.5, 1091), 6.12);
	
	loopSound("org_pouring_2", (235, 736.5, 985), 6.048);
	loopSound("org_dripping_1", (189.5, 554, 967), 11.089);
	loopSound("org_dripping_2", (282, 318.5, 985), 11.439);
	loopSound("org_dripping_2", (216.5, -43.5, 986), 9.962);

	loopSound("amb_Sci_Center_Air_Vent_2", (638, 324, 1091), 3.836);
	loopSound("amb_Sci_Center_Air_Vent_1", (254, -175, 1116), 4.214);
	
	



//Room 2 (Staircase)
	
	loopSound("amb_stairway_vent_1", (553, 441, 938), 4.821);
	loopSound("amb_light_buzz", (352, 242, 850), .008);

//Room 3
	
	loopSound("amb_light_buzz", (246, -300, 848),.008);
	loopSound("amb_light_buzz", (-240, 299, 852), .008);
	loopSound("amb_fan_treyarch_ribbon", (137, 23, 814), 8.747);
	loopSound("amb_fan_treyarch_ribbon", (-215, 15, 820), 8.747);
	loopSound("amb_fan_buzzy_1", (112, -285, 845), 10.640);
	


//Room 4


	loopSound("amb_light_buzz", (-239, 572, 852), .008);	
	loopSound("amb_light_buzz", (241, 571, 852), .008);
	//loopSound("amb_Sci_Center_Air_Vent_2", (42, 431, 825), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_2", (275, 483, 663), 4.214);
	//loopSound("amb_Sci_Center_Mech_1", (-117, 473, 738), 4.214);
	loopSound("amb_pipe", (-252, 541, 801), 6.12);
	loopSound("amb_pipe", (77, 435, 801), 6.12);
	
	loopSound("panel_buzz", (-321, 517, 815) ,.005);
	


//Catwalk
	
	//loopSound("amb_Sci_Center_Air_Vent_1", (81, 2013, 843), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (157, 1938, 817), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (89, 1612, 773), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (243, 852, 842), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-129, 1294, 800), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-104, 2436, 796), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (45, 2435, 795), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (315, 2818, 783), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (118, 3029, 781), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-143, 2816, 7971), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (294, 2641, 789), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-138, 2814, 795), 4.214);
	loopSound("amb_Sci_Center_Air_Vent_1", (-298, 2211, 780), 4.214);
	loopSound("Amb_Rain_Int_01", (14, 2014, 963), 6.12);
	loopSound("amb_pipe", (-279, 1074, 792), 6.12);
	loopSound("amb_Sci_Center_Air_Vent_2", (216, 1364, 829), 6.12);
	loopSound("amb_Sci_Center_Mech_1", (-249, 748, 776), 4.214);
	loopSound("steam_leak_high", (-72, 2198, 749), 8.874);
	loopSound("steam_leak_low", (-72, 2198, 749), 7.679);
	loopSound("panel_buzz", (-293, 2815, 745) ,.005);
	loopSound("panel_buzz", (328, 2678, 725) ,.005);
	loopSound("amb_Sci_Center_Air_Vent_1", (-167, 2815, 801) , 4.214);
	
//Stairwell with Rope Slide

	loopSound("amb_stairway_vent_1", (-249, 748, 776), 4.821);
	loopSound("amb_light_buzz", (-398, 2801, -2), 4.214);
	loopSound("amb_light_buzz", (-430, 2808, 197), 4.214);
	loopSound("amb_light_buzz", (-392, 2829, 464), 4.214);	
	loopSound("amb_Sci_Center_Air_Vent_2", (-437, 2866, 466), 4.214);
	loopSound("amb_Sci_Center_Air_Vent_2", (-465, 2896, 222), 4.214);

//Hallway 1

	loopSound("amb_pipe", (-546, 2597, -41), 6.12);

//Hallway 2

	loopSound("amb_fan_buzzy_1", (177, 3568, 10), 10.640);
	//loopSound("amb_Sci_Center_Air_Vent_1", (106, 3772, 12), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-134, 3771, 11), 4.214);
	//loopSound("amb_Sci_Center_Air_Vent_1", (-278, 3571, 11), 4.214);
	loopSound("amb_pipe", (-289, 3861, -36), 6.12);
	loopSound("amb_pipe", (210, 3838, -59), 6.12);

//Hallway 3


//Security Room

	//loopSound("amb_laptop", (-22, 2817, -41), 4.214);
	loopSound("amb_hardDrive_access_01", (-50, 2967, -77) , 4.214);
	//loopSound("amb_hardDrive_access_02", (-49, 2858, -67), 4.214);
	//loopSound("amb_hardDrive_access_01", ((-61, 2943, -55) ), 4.214);
	loopSound("amb_hardDrive_access_02", (588, 3039, -90), 4.214);
	loopSound("amb_tv_hum", (4, 2602, -52), 1.158);
	loopSound("amb_tv_hum", (-53, 2739, -50), 1.158);
	loopSound("amb_tv_hum", (-44, 2883, -42), 1.158);
	
	loopSound("monitor_noise", (-57, 2778, -56) , 8.000);
	


//Storeroom 1

	loopSound("amb_light_buzz", (-499, 3057, -8), 4.214);
	loopSound("amb_light_buzz", (-485, 3389, -11), 4.214);

//Storeroom 2

	loopSound("amb_light_buzz", (-1, 3684, -3), 4.214);
	loopSound("amb_light_buzz", (-200, 3029, 11), 4.214);
	
	
	
	
	

//ambients


	package = "catwalk_pkg";
	declareAmbientPackage( package );

	package = "stair_pkg";
	declareAmbientPackage( package );

	package = "halls_pkg";
	declareAmbientPackage( package );

	package = "elev_pkg";
	declareAmbientPackage( package );

	package = "main_pkg";
	declareAmbientPackage( package );

	package = "basement_pkg";
	declareAmbientPackage( package );
	

	room = "catwalk_room";
	declareAmbientRoom( room );
	setAmbientRoomTone( room, "amb_bg_sci_center_catwalk_int" ,.5, .5 );
	setAmbientRoomReverb( room, "auditorium", 1, .5 );

	room = "stair_room";
	declareAmbientRoom( room );
	setAmbientRoomTone( room, "amb_bg_sci_center_stairwell_int" ,.5, .5 );
	setAmbientRoomReverb( room, "stonecorridor", 1, .5 );

	room = "halls_room";
	declareAmbientRoom( room );
	setAmbientRoomTone( room, "amb_bg_sci_center_catwalk_int" ,.5, .5 );
	setAmbientRoomReverb( room, "hallway", 1, .5 );

	room = "elev_room";
	declareAmbientRoom( room );
	setAmbientRoomTone( room, "amb_bg_elevator_shaft" ,.5, .5 );
	setAmbientRoomReverb( room, "room", 1, .7 );

	room = "main_room";
	declareAmbientRoom( room );
	setAmbientRoomTone( room, "amb_bg_sci_center_main_hall" ,.5, .5 );
	setAmbientRoomReverb( room, "auditorium", 1, .7 );

	
	setBaseAmbientPackageAndRoom( "halls_pkg", "halls_room");
	signalAmbientPackageDeclarationComplete();
	
	room = "basement_room";
	declareAmbientRoom( room );
	setAmbientRoomTone( room, "amb_bg_sci_center_catwalk_int_2" ,.5, .5 );
	setAmbientRoomReverb( room, "hallway", 1, .5 );



//********************************* start scripts ****************************

array_thread(GetEntArray("puddle_trigger", "targetname"), ::puddle);
array_thread(GetEntArray("fence_trigger", "targetname"), ::fence);
array_thread(GetEntArray("pipe_trigger", "targetname"), ::pipe);
array_thread(GetEntArray("ladder_trigger", "targetname"), ::ladder);
array_thread(GetEntArray("water_tank", "targetname"), ::water_tank);

array_thread(GetEntArray("rattle_trigger", "targetname"), ::creak);

array_thread(GetEntArray("scaffold_trigger", "targetname"), ::creak);
array_thread(GetEntArray("scaffold_trigger", "targetname"), ::dock_plank);

array_thread(GetEntArray("cart_trigger", "targetname"), ::cart);

array_thread(GetEntArray("desk_trigger", "targetname"), ::desk);

array_thread(GetEntArray("wood_trigger", "targetname"), ::wood);
array_thread(GetEntArray("wood_trigger", "targetname"), ::desk);

array_thread(GetEntArray("clock_damage_trigger", "targetname"), ::clock_loop);
array_thread(GetEntArray("clock_damage_trigger", "targetname"), ::clock_damage);

array_thread(GetEntArray("soda_trigger", "targetname"), ::soda_loop);
array_thread(GetEntArray("soda_trigger", "targetname"), ::soda_damage);

array_thread(GetEntArray("sound_copier", "targetname"), ::copier_loop);

level thread rooftop_rain_1();
level thread rooftop_rain_2();

}



//********************************* functions ********************************




rooftop_rain_1()
{
	rooftop_rain_1_zone_var = GetEnt("rooftop_rain_1_zone", "targetname");
	if ( IsDefined(rooftop_rain_1_zone_var))
	{
		rooftop_rain_1_zone_var playloopsound ("rooftop_rain_int_1");
	}
}

rooftop_rain_2()
{
	rooftop_rain_2_zone_var = GetEnt("rooftop_rain_2_zone", "targetname");
	if ( IsDefined(rooftop_rain_2_zone_var))
	{
		rooftop_rain_2_zone_var playloopsound ("rooftop_rain_int_2");
	}
}


//***************************************** mutings ******************************


/*

mute_a_1()
{
	rooftop_rain_1_zone_var = GetEnt("rooftop_rain_1_zone", "targetname");
	if ( IsDefined(rooftop_rain_1_zone_var))
	{
		rooftop_rain_1_zone_var playloopsound ("rooftop_rain_int_1");
	}
}

mute_b_1()
{
	rooftop_rain_2_zone_var = GetEnt("rooftop_rain_2_zone", "targetname");
	if ( IsDefined(rooftop_rain_1_zone_var))
	{
		rooftop_rain_2_zone_var playloopsound ("rooftop_rain_int_2");
	}
}

*/

//************ fence ************

fence()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("fence_bump");
				//iprintlnbold ("SOUND: fence rustle");
				level notify("noise_trigger_fence");
				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}

//************ puddles ************

puddle()
{

	//puddle_org_var = GetEnt(self.target, "targetname");
	//level endon ("insert_notify");
	//if ( IsDefined(puddle_org_var) )
			
	
		while (1)
		{
			self waittill ("trigger");
			
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("step_puddle");
				//iprintlnbold ("SOUND: puddle splash");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}

				
		}
		

	
}

/************ pipe ************/

pipe()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("metal_drum");
				//iprintlnbold ("SOUND: metal_drum");
				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			

			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}

//************ water tank************

water_tank()
{

	//self endon("stop_tank");

	while(1)
	{
		random_time = randomintrange(5,15);
		wait(random_time);
		self playsound ("AMB_Water_Tank");
		//iprintlnbold ("SOUND: tank gurgle");
	
	}
}

water_tank_loop()
{
	self playloopsound ("amb_water_tank_loop");	

}


//************ ladder ************

ladder()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("ladder_bump");
				//iprintlnbold ("SOUND: ladder bump");
				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			

			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}

//************ catwalk ************

creak()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("catwalk_creak");
				//iprintlnbold ("SOUND: catwalk_creak");
				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			

			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}


//************ dock_plank ************

dock_plank()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("dockwood");
				//iprintlnbold ("SOUND: dock wood");
				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}

//************ cart ************

cart()
{
		
		while (1)
		{
			self waittill ("trigger");
			

			self playsound ("luggage_cart_bump");
			//iprintlnbold ("SOUND: cart noise");
			while ( level.player isTouching(self))
			{
			wait 0.1;
			}
				
		}
		
}

//************ desk ************

desk()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("cabinet_bump");
				//iprintlnbold ("SOUND: bookcase");
				level notify("noise_trigger_bookcase");

				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}

//************ wood ************

wood()
{
	

			
		while (1)
		{
			self waittill ("trigger");
			
			if ( 100 < lengthsquared( level.player getplayervelocity() ) )
			{
				self playsound ("rowboat");
				//iprintlnbold ("SOUND: barrel");
				level notify("noise_trigger_barrel");
				
				while ( level.player isTouching(self))
				
				{
				wait 0.1;
				}
			}
			
			else
			{
				//iprintlnbold("too soft!");
				while ( level.player isTouching(self))
				{
				wait 0.1;
				}
			}
		}
		

	
}


//************ clock ************

clock_loop()
{

	self playloopsound ("amb_clocktick");

}	

	
clock_damage()
{

	self waittill ("trigger");
	//iprintlnbold ("SOUND: stop ticking");
	self stoploopsound();	
}


//************ soda ************

soda_loop()
{

	self playloopsound ("amb_sodaMachine");

}	

	
soda_damage()
{

	self waittill ("trigger");
	self playsound ("soda_machine_dispense");
	//iprintlnbold ("SOUND: soda damage");
	self stoploopsound();	
}


//************ copier ************

copier_loop()
{
	self playloopsound ("amb_copier");	
}

